<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script>  
    <script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
    <script type='text/javascript'>
    $(function()
  {
    $('#zone').change(function(){
      $('tbody').remove()
      init()      
    })
  })
    //https://docs.google.com/spreadsheets/d/1w6KmFxXb3qkXM1n7Eyq272NJkvpUlK-aDFdT4_DAxEE/edit?usp=sharing
    //https://docs.google.com/spreadsheets/d/e/2PACX-1vQLKBVlZtsC0V6bXEURcgRO31qRHDofwR1zrfu3r4plJtKM5g1FKHDkGD3NHRchsXuejzAvESgcaK42/pubhtml
    var publicSpreadsheetUrl = 'https://docs.google.com/spreadsheets/d/1Qatb5EwM883IvFbARIwIWUyZ9lB2XhdVSxOEMsFS4h0/pubhtml';
    //Live
    //https://docs.google.com/spreadsheets/d/e/2PACX-1vSdhf90qNqYGAOXHSWdv-nOryHRXp4P6YNk2ny9cY8Wv00dr3K4rnCm-JjIbC56jymc7Q_uZfE2Nenw/pubhtml
    //https://docs.google.com/spreadsheets/d/1Qatb5EwM883IvFbARIwIWUyZ9lB2XhdVSxOEMsFS4h0/edit?usp=sharing
  
    function init() {        
      Tabletop.init( { key: publicSpreadsheetUrl,        
                       callback: showInfo,                       
                       simpleSheet: true                    
                        })
    }
  
    function showInfo(data, tabletop) {
      
      //alert('Successfully processed!')
      //alert($('#zone').val());
      var flr = data.filter(function(entry){
        return entry.Zone === $('#zone').val()
      })
      var tr;      
    for (var i = 0; i < flr.length; i++) {
      tr = $('<tr/>');
      tr.append("<td>" + flr[i].Level + "</td>");
      tr.append("<td>" + flr[i].Jan + "</td>");
      tr.append("<td>" + flr[i].Feb + "</td>");            
      tr.append("<td>" + flr[i].Mar + "</td>");            
      tr.append("<td>" + flr[i].Apr + "</td>");            
      tr.append("<td>" + flr[i].May + "</td>");            
      tr.append("<td>" + flr[i].Jun + "</td>");            
      tr.append("<td>" + flr[i].Jul + "</td>");            
      tr.append("<td>" + flr[i].Aug + "</td>");            
      tr.append("<td>" + flr[i].Sep + "</td>");            
      tr.append("<td>" + flr[i].Oct + "</td>");            
      tr.append("<td>" + flr[i].Nov + "</td>");            
      tr.append("<td>" + flr[i].Dec + "</td>");            
      $('.table').append(tr);
    }      
    }
    window.addEventListener('DOMContentLoaded', init)    
  </script>  
  <style>
  th, tr, p, h3 {
    text-align: center
  }    
  </style>
</head>
    <body>
      <div class="container">
        <p>In His Name and By The Grace of His Last Hujjat (a.t.f.s)</p>        
        <h3>Monthly Report Status 2020</h3>
        <label>Select Zone :</label>
        <select id="zone" class="target">
          <option value="Z1">Z1</option>
          <option value="Z2">Z2</option>
          <option value="Z3">Z3</option>
          <option value="Z4">Z4</option>
          <option>Z5</option>
          <option>Z6</option>
          <option>Z7</option>
          <option>Z8</option>
        </select>
        <br><br>
    <table class="table table-bordered">
      <thead>
        <tr>
            <th>Level</th>
            <th>Jan</th>
            <th>Feb</th>
            <th>Mar</th>
            <th>Apr</th>
            <th>May</th>
            <th>Jun</th>
            <th>Jul</th>
            <th>Aug</th>
            <th>Sep</th>
            <th>Oct</th>
            <th>Nov</th>
            <th>Dec</th>
        </tr>
      </thead>
      <tbody>
      </tbody>
    </table>
  </div>
  </body>
  </html>